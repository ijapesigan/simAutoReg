---
title: "simAutoReg: Vector Autoregressive Model - VAR(p)"
author: "Ivan Jacob Agaloos Pesigan"
output: rmarkdown::html_vignette
bibliography: "vignettes.bib"
csl: https://raw.githubusercontent.com/citation-style-language/styles/master/apa.csl
nocite: |
  @*
vignette: >
  %\VignetteIndexEntry{simAutoReg: Vector Autoregressive Model - VAR(p)}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r}
#| include = FALSE
knitr::opts_chunk$set(
  collapse = TRUE,
  fig.path = "fig-vignettes-",
  fig.cap = "",
  fig.width = 11,
  fig.height = 8,
  fig.retina = 2,
  dpi = 300,
  comment = "#>"
)
```

## Data Generation

### Normal

```{r}
library(simAutoReg)
set.seed(42)
time <- 10000L
burn_in <- 200
k <- 3
p <- 2
constant <- c(1, 1, 1)
coef <- matrix(
  data = c(
    0.4, 0.0, 0.0, 0.1, 0.0, 0.0,
    0.0, 0.5, 0.0, 0.0, 0.2, 0.0,
    0.0, 0.0, 0.6, 0.0, 0.0, 0.3
  ),
  nrow = k,
  byrow = TRUE
)
chol_cov <- chol(
  matrix(
    data = c(
      0.1, 0.0, 0.0,
      0.0, 0.1, 0.0,
      0.0, 0.0, 0.1
    ),
    nrow = k,
    byrow = TRUE
  )
)
y <- SimVAR(
  time = time,
  burn_in = burn_in,
  constant = constant,
  coef = coef,
  chol_cov = chol_cov
)
```

##  Model Fitting

### FitVAROLS

```{r}
yx <- YX(data = y, p = p)
FitVAROLS(Y = yx$Y, X = yx$X)
```

### vars::VAR

```{r}
fit <- vars::VAR(y, p = p, type = "const")
fit
plot(fit)
```

### Zero-inflated Poisson

```{r}
y <- SimVARZip(
  time = time,
  burn_in = burn_in,
  constant = constant,
  coef = coef,
  chol_cov = chol_cov
)
hist(y[, 1])
```

##  Model Fitting

### FitVAROLS

```{r}
yx <- YX(data = y, p = p)
FitVAROLS(Y = yx$Y, X = yx$X)
```

### vars::VAR

```{r}
fit <- vars::VAR(y, p = p, type = "const")
fit
plot(fit)
```
